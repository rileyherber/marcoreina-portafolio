---
title: "Future Exercise"
---

```{r}
library(dslabs)

# only run the next command interactively, not in a script
# help(gapminder)  
# get an overview of data structure
str(gapminder)

# get a summary of data
summary(gapminder)

# determine the type of object gapminder is
class(gapminder)
```

```{r}
africandata <- subset(gapminder, continent %in% "Africa") #subsetting data for african countries

# get an overview of data structure
str(africandata)

# get a summary of data
summary(africandata)

# determine the type of object 
class(africandata)

```

```{r}
infant_mortality_data <- data.frame(africandata$infant_mortality, africandata$life_expectancy) #making a dataframe for infant mortality
population_data <- data.frame(africandata$population, africandata$life_expectancy) #making a dataframe for infant mortality
```

```{r}
# get an overview of data structure
str(infant_mortality_data)

# get a summary of data
summary(infant_mortality_data)
```

```{r}
# get an overview of data structure
str(population_data)

# get a summary of data
summary(population_data)
```

```{r}
#ploting infant mortality vs life expectancy
plot(infant_mortality_data$africandata.infant_mortality, infant_mortality_data$africandata.life_expectancy)
```

```{r}
 #ploting population vs life expectancy
 plot(log(population_data$africandata.population, base = 2), population_data$africandata.life_expectancy)
 
# In both plots, streak patterns occur because each country contributes multiple times across different years and they tend to grow.
```

```{r}
missingyears <- is.na(infant_mortality_data$africandata.infant_mortality)

missingyears_df <- data.frame(africandata$year, missingyears)

plot(missingyears_df)

```

```{r}
africandata_year2000 <- subset(africandata, year %in% 2000)

# get an overview of data structure
str(africandata_year2000)

# get a summary of data
summary(africandata_year2000)
```

```{r}
#replotting only year 2000
plot(africandata_year2000$infant_mortality, africandata_year2000$life_expectancy)

plot(log(africandata_year2000$population, base = 2), africandata_year2000$life_expectancy)
```

```{r}
#lm base on year 2000

fit1 <- lm(life_expectancy ~ infant_mortality, data = africandata_year2000)
summary(fit1)

fit2 <- lm(life_expectancy ~ population, data = africandata_year2000)
summary(fit2)
```

```{r}
#This section contributed by Riley Herber.

#More Data Exploration

#Analysis of Concentrations of the three main greenhouse gases carbon dioxide, methane and nitrous oxide from 1-2000 CE.

#summary(greenhouse_gases)
data <- greenhouse_gases

#creates a data.frame object for each gas including year and concentrations
CO2 <- greenhouse_gases[greenhouse_gases$gas == "CO2", ]
CH4 <- greenhouse_gases[greenhouse_gases$gas == "CH4", ]
N2O <- greenhouse_gases[greenhouse_gases$gas == "N2O", ]


# set up an empty plot using all data to get axis limits
plot(
  greenhouse_gases$year,
  greenhouse_gases$concentration,
  type = "n",                
  xlab = "Year",
  ylab = "Concentration",
  main = "Greenhouse Gas Concentrations Over Time"
)

# add lines for each gas
lines(CO2$year, CO2$concentration, col = "blue", lwd = 2)
lines(CH4$year, CH4$concentration, col = "green", lwd = 2)
lines(N2O$year, N2O$concentration, col = "red", lwd = 2)

# add legend
legend(
  "topleft",
  legend = c("CO2", "CH4", "N2O"),
  col = c("blue", "green", "red"),
  lwd = 2
)

#ChatGPT was used to help me learn how to do multi-panel figure (code below)
par(mfrow = c(3, 1))  # plot with 3 rows, 1 column

plot(CO2$year, CO2$concentration, type = "l",
     main = "CO2", xlab = "Year", ylab = "Concentration")

plot(CH4$year, CH4$concentration, type = "l",
     main = "CH4", xlab = "Year", ylab = "Concentration")

plot(N2O$year, N2O$concentration, type = "l",
     main = "N2O", xlab = "Year", ylab = "Concentration")

par(mfrow = c(1, 1))  # reset layout

fit3 <- lm(concentration ~ year * gas, data = greenhouse_gases)
summary(fit3)
```

Analysis of greenhouse gas concentrations from 1â€“2000 CE revealed significant temporal trends that differed by gas type. Methane (CH4) exhibited a strong positive increase over time (CH4 slope = 0.138 per year and p < 0.001), whereas carbon dioxide (CO2) and nitrous oxide (N2O) had much lower baseline concentrations and minimal growth (CO2 adjusted slope = 0.009 per year; N2O adjusted slope = 0.008 per year; both p < 0.001). The interaction between year and gas was highly significant, indicating that the rate of increase varied across gases. Overall, the model explained 88% of the variance in concentrations (adjusted R-squared = 0.877), highlighting that CH4 has risen much more rapidly than CO2 or N2O over the past two millennia.